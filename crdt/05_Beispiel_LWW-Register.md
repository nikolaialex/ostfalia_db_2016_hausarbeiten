# 5. Beispiel Last Writer Wins Register (LWW-Register)
Das Last Writer Wins Register wurde ausgewählt, da es auf leicht verständliche Weise die CRDT-Eigenschaften, welche bei einem Datentyp zu beachten sind, verdeutlicht.  
Bei einem LWW-Register wird dem Speicherinhalt des jeweiligen Registers ein Zeitstempel zugeordnet. Damit steht ein Wert-Zeitstempel-Paar (value, timestamp) zur Verfügung, welches anhand des Zeitstempels eindeutig identifizierbar und zuordenbar ist. Nach jeder Operation wird der daraus resultierende neue Wert mit einem ebenfalls neuen, aktuellen Zeitstempel verknüpft. Wenn der nach einer Operation entstandene neue Status einer Replik im Zusammenhang mit der angestrebten Konvergierung zu den anderen Repliken gelangt, vergleicht die Zusammenführungsfunktion (merge) die Zeitstempel und übernimmt die Daten mit den höheren (also neueren) Werten. Dies ist die Vorgehensweise, aus welcher letztlich auch der Name entspringt – Last Writer Wins. Dabei ist es egal, wann die Repliken ihren Status weiterleiten. In Abbildung 4 ist dies deutlich dargestellt.  
Die Abbildung gibt eine Art Timeline wider, in welcher der zeitliche Verlauf von links nach rechts in Pfeilrichtung verläuft. Die Repliken x1 – x3 im linken Teil des Zeitstrahls nehmen zunächst lokal jede für sich aus dem für alle Repliken gleichen Ausgangsstatus (0, 0) über eine Operation einen neuen Status an. Dies geschieht zeitversetzt und ist mit einem farbigen Kreis gekennzeichnet, welcher den Buchstaben „S“ enthält. Damit nimmt also Replik x2 zuerst einen neuen Status an (2, 1), dann x3 (3, 2) und zuletzt x1 (1, 3). Der Statusaustausch zur Konvergierung geschieht dann willkürlich. Zuerst sendet x2 seinen Status an x3 und konvergiert dort auf den später generierten Status von x3 (3, 2). Anschließend senden etwa zeitgleich x2 und x1 ihre Status zu x1 respektive x3. x1 behält bei der Zusammenführung seine ja zuletzt generierten Status (1, 3), während x3 nunmehr auch auf diesen konvergiert. Damit muss nur noch x2 den Status von einem der beiden anderen, die nunmehr bereits auf dem letzten Stand sind, erhalten. Damit wäre dann der Datenbestand im gesamten System konsistent. Allerdings ist diese Aktion in der Abbildung nicht mehr enthalten.  
Ergänzend ist noch auf die Idempotenz hinzuweisen. Es ist ebenso egal, ob eine Replik einen Status mehrfach erhält. Durch den Zeitstempel ändert sich dadurch am Ergebnis nichts.

![Integer LWW Register (state-based)](https://github.com/achatzSWT/ostfalia_db_2016_hausarbeiten/blob/master/crdt/Bilder/LWW.JPG)

**Abbildung 4: Integer LWW Register (state-based). Payload is a pair (value, timestamp) (Shapiro et al. 2011a, S. 18)**

